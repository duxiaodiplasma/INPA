import sys
sys.path.insert(0,'/home/duxiaodi/inpa/SOURCE')
import creatobj
import numpy as np
import output4_fidasim


def main():

    # lower phosphor
    lphor = np.array([
    [-2216.0125898,664.0300435,-752.7063991],
    [-2231.8362094,587.3225107,-770.4562785],
    [-2196.3541534,591.1636874,-818.6876902],
    [-2180.5305338,667.8712202,-800.9378107]])

    # upper phosphor
    uphor = np.array([
    [-2260.4624551,659.4353424,-738.4681449],
    [-2274.3157469,592.2792896,-754.0078423],
    [-2241.9685667,586.9779584,-759.9344985],
    [-2228.1152749,654.1340112,-744.3948012]])

    # 1mm*1mm pinhole
    pinhole = np.array([
    [-2177.2325665,708.6971208,-715.1376413],
    [-2174.7099063,704.6620776,-713.6031670],
    [-2171.7530683,704.9821756,-717.6224514],
    [-2174.2757285,709.0172189,-719.1569256]])

    # stripping foil
    foil = np.zeros((7,4,3))

    foil[0,:,:] = np.array([
    [ -2211.7714400, 702.3877156, -738.4018213],
    [ -2213.0632108, 696.1256496, -739.8508435],
    [ -2207.5894820, 696.7182184, -747.2913838],
    [ -2206.2977112, 702.9802844,  -745.8423616]])

    foil[1,:,:] = np.array([
    [ -2213.7432863,692.8288745,-740.6137068],
    [ -2215.0350571,686.5668085,-742.0627290],
    [-2209.5613283,687.1593773,-749.5032693],
    [-2208.2695575,693.4214433,-748.0542471]])

    foil[2,:,:] = np.array([
    [-2215.7151326, 683.2700335,-742.8255923],
    [-2217.0069034,677.0079675,-744.2746145],
    [-2211.5331746,677.6005363,-751.7151547],
    [-2210.2414038,683.8626023,-750.2661326]])

    foil[3,:,:] = np.array([
    [-2217.6869789,673.7111924,-745.0374777],
    [-2218.9787497,667.4491264,-746.4864999],
    [-2213.5050209,668.0416952,-753.9270402],
    [-2212.2132502,674.303761,-752.4780180]])

    foil[4,:,:] = np.array([
    [ -2219.6588252,664.1523513,-747.2493632],
    [-2220.9505960, 657.8902853,-748.6983854],
    [-2215.4768672,658.4828541,-756.1389257],
    [ -2214.1850965,664.7449201,-754.6899035]])

    foil[5,:,:] = np.array([
    [-2221.6306715,654.5935103,-749.4612487],
    [-2222.9224423, 648.3314443,-750.9102709],
    [ -2217.4487136,648.9240131,-758.3508111],
    [-2216.1569428,655.1860791,-756.9017890]])

    foil[6,:,:] = np.array([
    [-2223.6025179, 645.0346692,-751.6731341],
    [-2224.8942886,638.7726032,-753.1221563],
    [-2219.4205599,639.3651720,-760.5626966],
    [-2218.1287891,645.6272380,-759.1136744]])

    geo = creatobj.geometry(pinhole/1e3,foil/1e3,uphor/1e3,lphor/1e3)

    # generate the input file of INPA GEOMETRY for FIDASIM
    grids = output4_fidasim.main2('/home/duxiaodi/inpa/OUTPUT/inpa.geometry',geo)

    return geo



